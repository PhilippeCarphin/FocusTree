<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Focus Tree</title>
    </head>
    <body>
        <H1>FocusTree.phil</H1>
        <p class="label" >Complete Tree:</p>
        <p id="output" >Output will go here</p>
        <p class="label" >Current Task:</p>
        <p id="current-task" >CURRENT TASK</p>
        <div><button id="send-button" onclick="sendCommand()" >SEND</button> <p id="command" >subtask new task text</p></div>
        <script type="application/javascript">
         let sendCommand = function(){
             let req = new XMLHttpRequest();
             req.onreadystatechange = function(){
                 if(this.readyState != 4){return;}
                 if(this.status != 200){console.log(this); return;}

                 updateTreeView();
                 updateCurrentTask();
             }

             req.open('POST', '/send-command');
             req.setRequestHeader("Content-type", "text/text");
             const command = document.getElementById('command').innerHTML;
             req.send(command);
         };

         let updateTreeView = function(){
             let req = new XMLHttpRequest();
             req.onreadystatechange = function(){
                 if(this.readyState != 4){return;}
                 if(this.status != 200){console.log(this); return;}

                 document.getElementById("output").innerHTML = this.responseText;
             };
             req.open('GET', '/fuck_my_face')
             req.send()
         };
         updateTreeView();

         let updateCurrentTask = function(){
             req = new XMLHttpRequest();
             req.open('GET', '/current-task', true);
             req.onreadystatechange = function(){
                 if(this.readyState != 4){return;}
                 if(this.status != 200){console.log(this); return;}

                 document.getElementById('current-task').innerHTML = this.responseText

             };
             req.send();
         }
         updateCurrentTask()
        </script>
    </body>
</html>
