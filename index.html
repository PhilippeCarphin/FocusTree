<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Focus Tree</title>
    </head>
    <body>
        <H1>FocusTree.phil</H1>
        <p id="output" >Output will go here</p>
        <p id="current-task" >CURRENT TASK</p>
        <div><button id="send-button" onclick="sendCommand('asdf')" >SEND</button> <p id="command" >INPUT FIELD FOR COMMAND</p></div>
        <script type="application/javascript">
         let sendCommand = function(message){
             let req = new XMLHttpRequest();
             req.onreadystatechange = function(){
                 if(this.readyState != 4){
                     return;
                 }

                 if(this.status != 200){
                     console.log("ERROR in response handler for send_command");
                     console.log(this);
                     return;
                 }

                 console.log(this);
             }

             req.open('POST', '/send-command');
             req.send();
         };
         document.write('<p>Hello world!</p>');
         let req = new XMLHttpRequest();
         req.onreadystatechange = function(){
            if(this.readyState != 4){
                return;
            }

            if(this.status != 200){
                console.log('ERROR handling response from request ...');
                console.log(this)
                return;
            }

            const rt = req.responseText;
            const ro = JSON.parse(rt);
            console.log(ro);
            // TODO Display JSON nicely
            document.getElementById("output").innerHTML = JSON.stringify(ro, null, 4);
         };
         req.open('GET', '0.0.0.0:8181/fuck_my_face')
         req.send()

        </script>
    </body>
</html>
